<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>로그 트리거 테스트 페이지</title>

  <script>
    const queryParams = new URLSearchParams(location.search);
    const projectKey = queryParams.get('projectKey');
    if (!projectKey) alert('projectKey가 전달되지 않았습니다.');

    const sdk = document.createElement('script');
    sdk.src = "https://behavior-tracking-sdk.vercel.app/sdk.js";
    sdk.dataset.key = projectKey;

    // 개발용 API 서버 분기
    if (location.hostname.includes('localhost')) {
      sdk.dataset.api = 'http://localhost:8080';
    }

    // ✅ 핵심 포인트: SDK 로드 완료 후 BehaviorSDK.init() 호출
    sdk.onload = () => {
      console.log('[SDK INIT] 호출됨:', {
        key: sdk.dataset.key,
        api: sdk.dataset.api
      });

      window.BehaviorSDK.init({
        projectKey: sdk.dataset.key,
        apiUrl: sdk.dataset.api,
        scrollThreshold: 0.3
      });
    };

    document.head.appendChild(sdk);
  </script>

  <style>
    body { font-family: sans-serif; padding: 2rem; }
    #scrollTarget { margin-top: 1500px; padding: 2rem; background: #f0f0f0; text-align: center; }
  </style>
</head>
<body>

<h1>✅ SDK 조건 트리거 테스트</h1>

<p>이 페이지는 다음 조건을 트리거합니다:</p>
<ul>
  <li>📄 page_view 전송</li>
  <li>🕒 일정 시간 체류 (예: 5초 이상 → stay_time)</li>
  <li>🖱 버튼 클릭 (click)</li>
  <li>⬇ 30% 이상 스크롤 (scroll_depth)</li>
</ul>

<hr>

<button onclick="alert('클릭 이벤트 발생!')">버튼 클릭 테스트</button>
<div id="scrollTarget">⬇ 여기까지 스크롤하면 scroll_depth 조건이 발동됩니다</div>

</body>
</html>
